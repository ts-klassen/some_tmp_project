# OWASP Top 10 2021 – A09 Security Logging & Monitoring Failures

## 概要
不十分なロギングやモニタリング、アラート設定の欠如により、インシデントを検知・対応できない、あるいは事後調査が困難になる問題。

## 代表的なシナリオ
### 1. 認証失敗ログの欠落
ブルートフォース攻撃を検知できず、SOC 連携も不可。

### 2. 機密情報を含むログ
パスワードやトークンを平文で出力し、ログサーバ経由で漏えい。

### 3. ログ改ざん
ローカルファイルにのみ保存し、攻撃者に削除・改ざんされる。

## 影響
- インシデントの長期未検知
- 事後フォレンジック不可
- コンプライアンス違反 (PCI DSS 等)

## セキュア設計 / 実装ガイド
1. 認証・権限関連イベント (ログイン成功/失敗, 権限変更) を必ずログ。
2. ログは改ざん困難な中央集約先 (ELK, CloudWatch, Splunk) へ送信。
3. 失敗回数や異常パターンに基づくリアルタイムアラートを設定。
4. 機密情報 (パスワード, カード情報, JWT) をマスキングして出力。

## フロントエンド開発者の観点
- 検出可能なエラー (HTTP 4xx, CORS 失敗) を適切にバックエンドへレポート。
- PII を含むログ送信を避け、匿名化 ID を使用。

## バックエンド開発者の観点
- ログレベルを環境変数で制御 (prod=INFO/WARN、debug 無効)。
- JSON 構造ログ + トレーシング ID (traceparent) を付加。

## 参考資料
- OWASP Logging Cheat Sheet
- CNCF OpenTelemetry
- NIST 800-92 Guide to Computer Security Log Management
